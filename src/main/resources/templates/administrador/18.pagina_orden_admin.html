<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Indrugs - Administrador</title>
    <script src="https://kit.fontawesome.com/14122cd484.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/1.estilos_pagina_inicio.css}">
    <link rel="stylesheet" th:href="@{/css/14.estilos_pagina_órdenes.css}">
</head>

<body>
<header th:insert="Layouts/header_footerAdmin :: header"></header>

<main class="cuerpo_indrugs">
    <div th:insert="Layouts/header_footerAdmin :: error"></div>
    <div class="contenido">
        <h1>Gestión de Órdenes</h1>

        <div th:if="${ordenes != null and !ordenes.isEmpty()}">
            <table id="tabla1" class="table">
                <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Paciente</th>
                    <th>EPS</th>
                    <th>Fecha de entrega</th>
                    <th>Dirección</th>
                    <th>Teléfono</th>
                    <th>Cantidad</th>
                    <th>Medicamentos</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="orden : ${ordenes}">
                    <td th:text="${orden.idOrden}"></td>
                    <td th:text="${orden.pacienteNombre}"></td>
                    <td th:text="${orden.epsOrden}"></td>
                    <td th:text="${#temporals.format(orden.fechaEntrega, 'yyyy-MM-dd HH:mm')}"></td>
                    <td th:text="${orden.direccionOrden}"></td>
                    <td th:text="${orden.telefonoOrden}"></td>
                    <td th:text="${orden.cantidad}"></td>
                    <td>
                        <ul class="list-unstyled">
                            <li th:each="medicamento : ${orden.medicamentos}" th:text="${medicamento}"></li>
                        </ul>
                    </td>
                    <td th:text="${orden.estadoOrden}"></td>
                    <td>
                       <a th:href="@{/ordenes/eliminar/{idOrden}(idOrden=${orden.idOrden})}" class="btn btn-danger">Eliminar</a>
                    </td>

<!--                    <td> -->
<!--                        <span th:class="${orden.estadoOrden == 'Entregada' ? 'badge bg-success' : 'badge bg-warning'}"-->
<!--                              th:text="${orden.estadoOrden}"></span>-->
<!--                    </td>-->
<!--                    <td>-->
<!--                        <div class="btn-group" role="group">-->
<!--                            <a th:href="@{/administrador/ordenes/entregar/{id}(id=${orden.idOrden})}"-->
<!--                               class="btn btn-success btn-sm"-->
<!--                               th:if="${orden.estadoOrden != 'Entregada'}">-->
<!--                                <i class="fas fa-check"></i> Entregar-->
<!--                            </a>-->
<!--                            <span th:if="${orden.estadoOrden == 'Entregada'}"-->
<!--                                  class="badge bg-success">-->
<!--                                <i class="fas fa-check-circle"></i> Entregada-->
<!--                            </span>-->
<!--                        </div>-->
<!--                    </td>-->
                </tr>
                </tbody>
            </table>
        </div>

        <div th:if="${ordenes == null or #lists.isEmpty(ordenes)}" class="alert alert-info text-center">
            <i class="fas fa-info-circle"></i> No hay órdenes registradas en el sistema.
        </div>

        <!-- Estadísticas adicionales para el administrador -->
<!--        <div class="row mt-4" th:if="${ordenes != null and #lists.isNotEmpty(ordenes)}">-->
<!--            <div class="col-md-3">-->
<!--                <div class="card bg-primary text-white">-->
<!--                    <div class="card-body">-->
<!--                        <h5 class="card-title">Total Órdenes</h5>-->
<!--                        <p class="card-text fs-4" th:text="${#lists.size(ordenes)}">0</p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3">-->
<!--                <div class="card bg-success text-white">-->
<!--                    <div class="card-body">-->
<!--                        <h5 class="card-title">Entregadas</h5>-->
<!--                        <p class="card-text fs-4" th:text="${#lists.size(#lists.select(ordenes, o -> o.estadoOrden == 'Entregada'))}">0</p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3">-->
<!--                <div class="card bg-warning text-white">-->
<!--                    <div class="card-body">-->
<!--                        <h5 class="card-title">Pendientes</h5>-->
<!--                        <p class="card-text fs-4" th:text="${#lists.size(#lists.select(ordenes, o -> o.estadoOrden != 'Entregada'))}">0</p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3">-->
<!--                <div class="card bg-info text-white">-->
<!--                    <div class="card-body">-->
<!--                        <h5 class="card-title">Medicamentos</h5>-->
<!--                        <p class="card-text fs-4" th:text="${#aggregates.sum(ordenes.![cantidad])}">0</p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
    </div>
</main>

<footer th:insert="Layouts/header_footerAdmin :: footer"></footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>